<div class="single-step-editor">
  <div class="preview" tabindex="0" role="link" (keypress)="handleKeypress($event)" #previewEl>
    <clip #preview
        (click)="setEditMode(true)"
        (imageFailed)="loadRandomPhoto()"
        [textVisible]="!editMode"
        [photo]="photo"
        [font]="font"
        [lines]="lines"
        [textFill]="textFill"
        [textFit]="textFit"
        [textPos]="textPos"
        [config]="size"
        [previewRatio]="previewRatio"
        [preview]="preview"></clip>
    <div class="controls-bar">
      <button #downloadBtn (click)="download(preview)">
        تحميل
      </button>
      <button #randomBtn (click)="random()">
        عشوائي
      </button>
    </div>
    <div class="credits-bar" *ngIf="photo && photo.showCredits">
      <div class="credits">
        <span> &lt; </span>
        <a [href]="photo.photographerLink" target="_blank">{{photo.photographerName}}</a>
        <span> / </span>
        <a [href]="photo.sourceLink" target="_blank">{{photo.sourceName}}</a>
        <span> &gt; </span>
      </div>
    </div>
    <div class="edit-textarea" [hidden]="!editMode">
      <textarea autosize #textarea
        (blur)="updateText($event.target.value)"
        (keyup)="handleKeyup($event)"
        [value]="text"
        ></textarea>
      <button (click)="updateText(textarea.value)">حفظ</button>
    </div>
  </div>
  <div class="controls-container">
    <clips-tabs>
      <clips-tab title="صور" (scrolled)="photosReachedEnd$.next()">
         <!-- add upload  -->
         <!-- add search  -->
        <clips-photos-selector (change)="updatePhoto($event)"></clips-photos-selector>
      </clips-tab>
      <clips-tab title="خط">
         <!-- add search  -->
        <clips-fonts-selector (change)="updateFont($event)"></clips-fonts-selector>
      </clips-tab>
      <clips-tab title="تنسيق">
        <clips-formats-selector (change)="updateFormats($event)"></clips-formats-selector>
      </clips-tab>
       <clips-tab title="اقتباسات" (scrolled)="quotesReachedEnd$.next()">
         <!-- add search  -->
         <yorwa-quotes-selector (change)="updateQuote($event)"></yorwa-quotes-selector>
       </clips-tab>
      <clips-tab title="حجم">
        <clips-sizes-selector (change)="updateSize($event)"></clips-sizes-selector>
      </clips-tab>
    </clips-tabs>
  </div>

  <iframe #exporterIframe [src]="exporterIframeSrc" class="export-iframe"></iframe>
</div>